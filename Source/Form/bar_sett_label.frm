VERSION 5.00
Object = "{3771C1D4-CBC4-476C-A80C-BC636FEF6851}#1.0#0"; "vsdflat3.ocx"
Begin VB.Form bar_sett_label 
   BackColor       =   &H8000000A&
   Caption         =   "Master Setting Label Form"
   ClientHeight    =   5835
   ClientLeft      =   -135
   ClientTop       =   645
   ClientWidth     =   10170
   ControlBox      =   0   'False
   DrawMode        =   7  'Invert
   DrawStyle       =   6  'Inside Solid
   BeginProperty Font 
      Name            =   "MS Sans Serif"
      Size            =   8.25
      Charset         =   0
      Weight          =   700
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   LinkTopic       =   "Form1"
   MDIChild        =   -1  'True
   ScaleHeight     =   5835
   ScaleWidth      =   10170
   WindowState     =   2  'Maximized
   Begin VB.Frame Frame1 
      BackColor       =   &H8000000A&
      Height          =   4695
      Index           =   0
      Left            =   360
      TabIndex        =   0
      Top             =   120
      Width           =   11775
      Begin VB.OptionButton Option1 
         Caption         =   "Model 2"
         Height          =   255
         Index           =   1
         Left            =   3960
         TabIndex        =   27
         Top             =   3960
         Width           =   1455
      End
      Begin VB.OptionButton Option1 
         Caption         =   "Model 1"
         Height          =   255
         Index           =   0
         Left            =   2400
         TabIndex        =   26
         Top             =   3960
         Width           =   1455
      End
      Begin VB.TextBox Text1 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BorderStyle     =   0  'None
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   11
         Left            =   3840
         TabIndex        =   22
         Text            =   "100"
         Top             =   3000
         Width           =   1455
      End
      Begin VB.TextBox Text1 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BorderStyle     =   0  'None
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   10
         Left            =   3840
         TabIndex        =   21
         Text            =   "100"
         Top             =   3360
         Width           =   1455
      End
      Begin VB.TextBox Text1 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BorderStyle     =   0  'None
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   9
         Left            =   2340
         TabIndex        =   20
         Text            =   "Text1"
         Top             =   3360
         Width           =   1455
      End
      Begin VB.TextBox Text1 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BorderStyle     =   0  'None
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   8
         Left            =   2340
         TabIndex        =   19
         Text            =   "Text1"
         Top             =   3000
         Width           =   1455
      End
      Begin VB.TextBox Text1 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BorderStyle     =   0  'None
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   7
         Left            =   5360
         TabIndex        =   16
         Text            =   "Text1"
         Top             =   1680
         Width           =   1455
      End
      Begin VB.TextBox Text1 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BorderStyle     =   0  'None
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   6
         Left            =   5360
         TabIndex        =   15
         Text            =   "Text1"
         Top             =   1320
         Width           =   1455
      End
      Begin VB.TextBox Text1 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BorderStyle     =   0  'None
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   5
         Left            =   3840
         TabIndex        =   14
         Text            =   "Text1"
         Top             =   1680
         Width           =   1455
      End
      Begin VB.TextBox Text1 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BorderStyle     =   0  'None
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   4
         Left            =   3840
         TabIndex        =   13
         Text            =   "Text1"
         Top             =   1320
         Width           =   1455
      End
      Begin VB.TextBox Text1 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BorderStyle     =   0  'None
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   3
         Left            =   2340
         TabIndex        =   12
         Text            =   "Text1"
         Top             =   1680
         Width           =   1455
      End
      Begin VB.TextBox Text1 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BorderStyle     =   0  'None
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   2
         Left            =   2340
         TabIndex        =   11
         Text            =   "Text1"
         Top             =   1320
         Width           =   1455
      End
      Begin VB.TextBox Text1 
         Appearance      =   0  'Flat
         BorderStyle     =   0  'None
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   0
         Left            =   2340
         TabIndex        =   2
         Text            =   "Text1"
         Top             =   240
         Width           =   1335
      End
      Begin VB.TextBox Text1 
         Appearance      =   0  'Flat
         BorderStyle     =   0  'None
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   285
         Index           =   1
         Left            =   2340
         TabIndex        =   1
         Text            =   "Text1"
         Top             =   600
         Width           =   7155
      End
      Begin VSDFLATS.FlatButton BrowseUserID 
         Height          =   255
         Left            =   3720
         TabIndex        =   3
         Top             =   240
         Width           =   495
         _ExtentX        =   873
         _ExtentY        =   450
         MouseIcon       =   "bar_sett_label.frx":0000
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Caption         =   "..."
      End
      Begin VB.Label Label1 
         Caption         =   "Model Format Barcode"
         Height          =   315
         Index           =   11
         Left            =   240
         TabIndex        =   25
         Top             =   3960
         Width           =   2055
      End
      Begin VB.Label Label1 
         Alignment       =   1  'Right Justify
         Caption         =   "MM"
         Height          =   315
         Index           =   10
         Left            =   2340
         TabIndex        =   24
         Top             =   2640
         Width           =   1455
      End
      Begin VB.Label Label1 
         Alignment       =   1  'Right Justify
         Caption         =   "Defaul MM"
         Height          =   315
         Index           =   9
         Left            =   3840
         TabIndex        =   23
         Top             =   2640
         Width           =   1455
      End
      Begin VB.Label Label1 
         Caption         =   "Dari Sebelah Kiri"
         Height          =   315
         Index           =   8
         Left            =   240
         TabIndex        =   18
         Top             =   3000
         Width           =   2055
      End
      Begin VB.Label Label1 
         Caption         =   "Dari Kanan"
         Height          =   315
         Index           =   7
         Left            =   240
         TabIndex        =   17
         Top             =   3360
         Width           =   2055
      End
      Begin VB.Label Label1 
         Alignment       =   1  'Right Justify
         Caption         =   "Defaul MM"
         Height          =   315
         Index           =   6
         Left            =   5360
         TabIndex        =   10
         Top             =   960
         Width           =   1455
      End
      Begin VB.Label Label1 
         Alignment       =   1  'Right Justify
         Caption         =   "MM"
         Height          =   315
         Index           =   5
         Left            =   3840
         TabIndex        =   9
         Top             =   960
         Width           =   1455
      End
      Begin VB.Label Label1 
         Alignment       =   1  'Right Justify
         Caption         =   "CM"
         Height          =   315
         Index           =   4
         Left            =   2340
         TabIndex        =   8
         Top             =   960
         Width           =   1455
      End
      Begin VB.Label Label1 
         Caption         =   "Tinggi"
         Height          =   315
         Index           =   3
         Left            =   240
         TabIndex        =   7
         Top             =   1680
         Width           =   2055
      End
      Begin VB.Label Label1 
         Caption         =   "Kode Basis"
         Height          =   315
         Index           =   0
         Left            =   240
         TabIndex        =   6
         Top             =   240
         Width           =   2055
      End
      Begin VB.Label Label1 
         Caption         =   "Keterangan"
         ForeColor       =   &H0000FF00&
         Height          =   315
         Index           =   1
         Left            =   240
         TabIndex        =   5
         Top             =   600
         Width           =   2055
      End
      Begin VB.Label Label1 
         Caption         =   "Lebar"
         Height          =   315
         Index           =   2
         Left            =   240
         TabIndex        =   4
         Top             =   1320
         Width           =   2055
      End
   End
End
Attribute VB_Name = "bar_sett_label"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
Dim oCon As New ADODB.Connection
Dim oRs As New ADODB.Recordset
Dim sQuery As String

Dim KataKunci As String
Dim KodeUserAksesTemp As String
Dim sUpdate As String
Dim sInsert As String
Dim istatus As StatusForm

Dim smodellabel As String
Dim sketerangan As String
Dim slebarcm As Double
Dim stinggicm As Double
Dim slebarmm As Double
Dim stinggimm As Double
Dim stxtpesan As String
Dim slebardefault As Double
Dim stinggidefault As Double
Dim sbar_finished_model As Integer
Dim sauditdate As String
Dim saudituser As String

Public Sub FindData(sKodeUserAkses As String)
On Error GoTo errhandler
    If oCon.State = 1 Then oCon.Close
     oCon.Open MainModule.Conectionku(DBaseConection.Modul)
    sQuery = "call spget_bar_sett_label_barcode('" & sKodeUserAkses & "',0)"
    Set oRs = oCon.Execute(sQuery)
    If Not oRs.EOF Then
        showData
        istatus = Normal
        MenuFrm.SetToolbarku Me, istatus, MenuFrm.sGroupUserID, mnbar_sett_label
    End If
    oCon.Close
    Exit Sub
errhandler:
    MainModule.ShowMessage Err.Description, "FindData"
End Sub
Public Sub MoveFirst()
On Error GoTo errhandler
    If oCon.State = 1 Then oCon.Close
     oCon.Open MainModule.Conectionku(DBaseConection.Modul)
    sQuery = "call spget_bar_sett_label_barcode('" & Text1(0) & "',1)"
    Set oRs = oCon.Execute(sQuery)
    If Not oRs.EOF Then
        showData
    End If
    oCon.Close
    Exit Sub
errhandler:
    MainModule.ShowMessage Err.Description, "MoveFirst"
End Sub

Public Sub MoveNext()
On Error GoTo errhandler
    If oCon.State = 1 Then oCon.Close
    oCon.Open MainModule.Conectionku(DBaseConection.Modul)
    sQuery = "call spget_bar_sett_label_barcode('" & Text1(0) & "',3)"
    Set oRs = oCon.Execute(sQuery)
    If Not oRs.EOF Then
        showData
    End If
    oCon.Close
Exit Sub
errhandler:
    MainModule.ShowMessage Err.Description, "MoveNext"
End Sub
Public Sub MovePrevious()
On Error GoTo errhandler
    If oCon.State = 1 Then oCon.Close
     oCon.Open MainModule.Conectionku(DBaseConection.Modul)
    sQuery = "call spget_bar_sett_label_barcode('" & Text1(0) & "',2)"
    Set oRs = oCon.Execute(sQuery)
    If Not oRs.EOF Then
        showData
    End If
    oCon.Close
    Exit Sub
errhandler:
    MainModule.ShowMessage Err.Description, "MovePrevious"
End Sub

Public Sub MoveLast()
On Error GoTo errhandler
    If oCon.State = 1 Then oCon.Close
     oCon.Open MainModule.Conectionku(DBaseConection.Modul)
    sQuery = "call spget_bar_sett_label_barcode('" & Text1(0) & "',4)"
    Set oRs = oCon.Execute(sQuery)
    If Not oRs.EOF Then
        showData
    Else
        cleardata
    End If
    oCon.Close
    Exit Sub
errhandler:
    MainModule.ShowMessage Err.Description, "MoveLast"
End Sub
Public Sub SaveData()
Dim ires As Integer
    ires = MsgBox("Simpan Data ini?", vbQuestion + vbYesNo, "Simpan Data")
    If ires = 6 Then
        If DoSaveData Then
                MenuFrm.slebar = ToNumber(Text1(4).text)
                MenuFrm.stinggi = ToNumber(Text1(5).text)
                MenuFrm.slebar = oFindByQuery("select lebarmm from bar_sett_label_barcode where modellabel=1", DBaseConection.Modul)
                MenuFrm.stinggi = oFindByQuery("select tinggimm from bar_sett_label_barcode where modellabel=1", DBaseConection.Modul)
'stxtpesan = oFindByQuery("select txtpesan tinggi from master_setting_kwitansi_form", DBaseConection.Modul)

'MenuFrm.sbar_finished_model = oFindByQuery("select bar_finished_model from bar_sett_label_barcode where modellabel=1", DBaseConection.Modul)

             MsgBox "Data Sudah Tersimpan", , "Simpan Data"
             MenuFrm.SetToolbarku Me, istatus, MenuFrm.sGroupUserID, mnbar_sett_label
        End If
    End If
End Sub
Public Sub DeleteData()
    Dim ires As Integer
    ires = MsgBox("Hapus Data ini?", vbQuestion + vbYesNo, "Hapus Data")
    If ires = 6 Then
        If DoDeleteData Then
             MsgBox "Data Sudah Terhapus", , "Hapus Data"
             MovePrevious
        End If
    End If
    MenuFrm.SetToolbarku Me, istatus, MenuFrm.sGroupUserID, mnbar_sett_label
End Sub
Private Function DoSaveData() As Boolean
On Error GoTo errhandler
    If setData Then
        If oCon.State = 1 Then oCon.Close
         oCon.Open MainModule.Conectionku(DBaseConection.Modul)
        If istatus = StatusForm.DataBaru Then
        sQuery = sInsert
        Else
        sQuery = sUpdate
        End If
        oCon.Execute sQuery
        oCon.Close
        DoSaveData = True
        istatus = Normal
        Exit Function
    End If
errhandler:
MainModule.ShowMessage Err.Description, "savedata"
End Function
Private Function DoDeleteData() As Boolean
On Error GoTo errhandler
    If setData Then
        If oCon.State = 1 Then oCon.Close
         oCon.Open MainModule.Conectionku(DBaseConection.Modul)
        sQuery = sQuery & "3)"
        oCon.Execute sQuery
        oCon.Close
        DoDeleteData = True
        istatus = Normal
        Exit Function
    End If
errhandler:
MainModule.ShowMessage Err.Description, "Delete Data"
End Function
Public Sub NewData()
    KodeUserAksesTemp = Text1(0)
    istatus = StatusForm.DataBaru
    cleardata
    MenuFrm.SetToolbarku Me, istatus, MenuFrm.sGroupUserID, mnbar_sett_label
    
    Text1(0).Locked = False
    Text1(0).SetFocus
    Text1(0).TabIndex = 0
    Text1(1).TabIndex = 1

End Sub
Public Sub Undo()
    istatus = Normal
    MenuFrm.SetToolbarku Me, istatus, MenuFrm.sGroupUserID, mnbar_sett_label
    FindData KodeUserAksesTemp
End Sub

Private Function setData() As Boolean
On Error GoTo errhandler

    smodellabel = ToText(Text1(0).text)
    sketerangan = ToText(Text1(1).text)
    slebarcm = ToNumber(Text1(2).text)
    stinggicm = ToNumber(Text1(3).text)
    slebarmm = ToNumber(Text1(4).text)
    stinggimm = ToNumber(Text1(5).text)
    slebardefault = ToNumber(Text1(6).text)
    stinggidefault = ToNumber(Text1(7).text)
    If Option1(0).value = True Then
        sbar_finished_model = 1
    Else
        sbar_finished_model = 2
    End If
    
    sQuery = "call sp_bar_sett_label_barcode ('"
    sQuery = sQuery & smodellabel & "','"
     sQuery = sQuery & sketerangan & "','"
      sQuery = sQuery & slebarcm & "','"
       sQuery = sQuery & stinggicm & "','"
        sQuery = sQuery & slebarmm & "','"
         sQuery = sQuery & stinggimm & "','"
          sQuery = sQuery & stxtpesan & "','"
          sQuery = sQuery & slebardefault & "','"
          sQuery = sQuery & stinggidefault & "','"
          sQuery = sQuery & ToText(Text1(8).text) & "','"
          sQuery = sQuery & ToText(Text1(9).text) & "','"
          sQuery = sQuery & sbar_finished_model & "','"
          sQuery = sQuery & MenuFrm.sUserID & "',"
          
    sUpdate = sQuery & "2)"
    
    sInsert = sQuery & "1)"
    
    setData = True
    Exit Function
errhandler:
MsgBox Err.Description, , "Set Data fail"
End Function

Private Sub BrowseUserID_Click()
Dim oBrowse As New BrowseFrm
oBrowse.ShowFinder BrowsBarSettLabelBarcode, "", ubAscending, DBaseConection.Modul
If Not oBrowse.YangDipilih = "" Then FindData oBrowse.YangDipilih
Set oBrowse = Nothing
End Sub

Private Sub Form_Activate()
Dim sTitle As String
sTitle = "Master Setting Label"
'lblTitle.Caption = "  : .  " & sTitle & "  . :  "
Me.Caption = " " & sTitle & " "
MenuFrm.SetToolbarku Me, istatus, MenuFrm.sGroupUserID, mnbar_sett_label
BrowseUserID.Top = Text1(0).Top
BrowseUserID.Height = Text1(0).Height
BrowseUserID.Left = Text1(0).Left + Text1(0).Width
End Sub

Private Sub Form_Load()
oInsertModulMenu Me.Name, Me.Caption, entrian, MenuFrm.sinsertmodul

oFormatWarnaLabel sWarnaLabel, sWarnaText, sWarnaBackcolour, Me
oFormatOption 1, Me
cleardata
istatus = Normal
MoveFirst
End Sub

Private Sub showData()
On Error GoTo errhandler


    cleardata
    Text1(0).text = oRs("modellabel")
    KodeUserAksesTemp = oRs("modellabel")
    Text1(0).Locked = True
    Text1(1).text = oRs("keterangan")
    Text1(2).text = ToNumber(oRs("lebarcm"))
    Text1(3).text = ToNumber(oRs("tinggicm"))
    Text1(4).text = ToNumber(oRs("lebarmm"))
    Text1(5).text = ToNumber(oRs("tinggimm"))
    Text1(6).text = ToNumber(oRs("lebardefault"))
    Text1(7).text = ToNumber(oRs("tinggidefault"))
    Text1(8).text = ToNumber(oRs("kiri"))
    Text1(9).text = ToNumber(oRs("kanan"))
    MenuFrm.slebar = ToNumber(Text1(4).text)
    MenuFrm.stinggi = ToNumber(Text1(5).text)
    MenuFrm.skiri = ToNumber(Text1(8).text)
    MenuFrm.skanan = ToNumber(Text1(9).text)
    If ToNumber(oRs("bar_finished_model")) = 1 Then
        Option1(0).value = True
        Option1(1).value = False
    Else
        Option1(0).value = False
        Option1(1).value = True
    End If
    Dim iText As Integer
    For iText = 0 To Text1.Count - 1
        Text1(iText) = RTrim(Text1(iText))
    Next
    
Exit Sub
errhandler:
    MainModule.ShowMessage Err.Description, "MoveFirst"
End Sub

Private Sub cleardata()
Dim i As Integer
For i = 0 To Text1.Count - 1
    Text1(i).text = ""
Next
    Text1(10) = 100
    Text1(11) = 100
End Sub
Public Sub Closeform()
Set oCon = Nothing
MenuFrm.SetToolbar MainMenu
Unload Me
ShowFormMessage MainMenumsg
End Sub

Private Sub Text1_Change(Index As Integer)
Select Case Index
Case 2
    Text1(4) = Round(((ToNumber(Text1(2)) / 21) * 11904), 0)
Case 3
    Text1(5) = Round(((ToNumber(Text1(3)) / 21) * 11904), 0)
End Select
End Sub

Private Sub Text1_GotFocus(Index As Integer)
MainModule.highlighttext Text1(Index)
Text1(Index).BackColor = &HC0C0C0
End Sub

Private Sub Text1_KeyDown(Index As Integer, KeyCode As Integer, Shift As Integer)
MainModule.DoKeyDown KeyCode, istatus
End Sub

Private Sub Text1_LostFocus(Index As Integer)
Text1(Index).BackColor = &H80000005
If Index = 0 Then FindData Text1(0).text
End Sub
